<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>Android</title>
  <style type="text/css">
      code{white-space: pre-wrap;}
      span.smallcaps{font-variant: small-caps;}
      span.underline{text-decoration: underline;}
      div.column{display: inline-block; vertical-align: top; width: 50%;}
  </style>
  <style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
  </style>
</head>
<body>
<nav id="TOC">
<ul>
<li><a href="#building-sdl2-for-android">Building SDL2 for Android</a><ul>
<li><a href="#existing-documentation">Existing documentation</a></li>
<li><a href="#pre-requisites">Pre-requisites</a></li>
<li><a href="#simple-builds">Simple builds</a><ul>
<li><a href="#sdl-wrapper-for-simple-programs">SDL wrapper for simple programs</a></li>
<li><a href="#sdl-wrapper-sdl_image-ndk-module">SDL wrapper + SDL_image NDK module</a></li>
</ul></li>
<li><a href="#build-an-autotools-friendly-environment">Build an autotools-friendly environment</a><ul>
<li><a href="#compile-a-shared-binaries-bundle-for-sdl-and-sdl_">Compile a shared binaries bundle for SDL and SDL_*</a></li>
<li><a href="#install-sdl-in-a-gcc-toolchain">Install SDL in a GCC toolchain</a></li>
<li><a href="#building-other-dependencies">Building other dependencies</a></li>
<li><a href="#build-your-autotools-app">Build your autotools app</a></li>
<li><a href="#build-your-cmake-app">Build your CMake app</a></li>
</ul></li>
<li><a href="#troubleshootings">Troubleshootings</a></li>
</ul></li>
</ul>
</nav>
<h1 id="building-sdl2-for-android">Building SDL2 for Android</h1>
<h2 id="existing-documentation">Existing documentation</h2>
<p>A lot of information can be found in <a href="https://hg.libsdl.org/SDL/file/default/docs/README-android.md.html">SDL/docs/README-android.md</a>.</p>
<p>This page is more walkthrough-oriented.</p>
<h2 id="pre-requisites">Pre-requisites</h2>
<ul>
<li>Install minimal Java environment. For instance, in Debian/Ubuntu:</li>
</ul>
<div class="sourceCode" id="cb1"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb1-1" title="1"><span class="fu">sudo</span> apt install openjdk-8-jdk ant android-sdk-platform-tools-common</a></code></pre></div>
<ul>
<li>Install NDK (tested with <a href="https://dl.google.com/android/repository/android-ndk-r10e-linux-x86_64.zip.html">r10e</a>)</li>
<li>Install the latest SDK, run <code>tools/bin/sdkmanager</code> (or <code>tools/android</code> pre-2017) and install one API
<dl>
<dt>&gt;=12 for SDL &lt; 2.0.8<br />
&gt;=19 for SDL &gt;= 2.0.8<br />
&gt;=26 for SDL &gt;= 2.0.16<br />
&gt;=31 for SDL &gt;= 2.0.18</dt>

</dl></li>
<li>Configure your environment variables, e.g.:</li>
</ul>
<div class="sourceCode" id="cb2"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb2-1" title="1"><span class="va">PATH=</span><span class="st">&quot;/usr/src/android-ndk-rXXx:</span><span class="va">$PATH</span><span class="st">&quot;</span>                  <span class="co"># for &#39;ndk-build&#39;</span></a>
<a class="sourceLine" id="cb2-2" title="2"><span class="va">PATH=</span><span class="st">&quot;/usr/src/android-sdk-linux/tools:</span><span class="va">$PATH</span><span class="st">&quot;</span>           <span class="co"># for &#39;android&#39;</span></a>
<a class="sourceLine" id="cb2-3" title="3"><span class="va">PATH=</span><span class="st">&quot;/usr/src/android-sdk-linux/platform-tools:</span><span class="va">$PATH</span><span class="st">&quot;</span>  <span class="co"># for &#39;adb&#39;</span></a>
<a class="sourceLine" id="cb2-4" title="4"><span class="bu">export</span> <span class="va">ANDROID_HOME=</span><span class="st">&quot;/usr/src/android-sdk-linux&quot;</span>        <span class="co"># for gradle</span></a>
<a class="sourceLine" id="cb2-5" title="5"><span class="bu">export</span> <span class="va">ANDROID_NDK_HOME=</span><span class="st">&quot;/usr/src/android-ndk-rXXx&quot;</span>     <span class="co"># for gradle</span></a></code></pre></div>
<h2 id="simple-builds">Simple builds</h2>
<h3 id="sdl-wrapper-for-simple-programs">SDL wrapper for simple programs</h3>
<ul>
<li>Compile a sample app (calls ndk-build):</li>
</ul>
<div class="sourceCode" id="cb3"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb3-1" title="1"><span class="bu">cd</span> /usr/src/SDL2/build-scripts/</a>
<a class="sourceLine" id="cb3-2" title="2"><span class="ex">./androidbuild.sh</span> org.libsdl.testgles ../test/testgles.c</a></code></pre></div>
<ul>
<li>Follow the instructions to install on your device:</li>
</ul>
<div class="sourceCode" id="cb4"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb4-1" title="1"><span class="bu">cd</span> /usr/src/SDL2/build/org.libsdl.testgles/</a>
<a class="sourceLine" id="cb4-2" title="2"><span class="ex">ant</span> debug install       <span class="co"># SDL &lt;= 2.0.7</span></a>
<a class="sourceLine" id="cb4-3" title="3"><span class="ex">./gradlew</span> installDebug  <span class="co"># SDL &gt;= 2.0.8</span></a></code></pre></div>
<p>Notes:</p>
<ul>
<li>multiple targets armeabi-v7a/arm64-v8a/x86/x86_64 compilation</li>
<li>application doesn't quit</li>
</ul>
<h4 id="troubleshooting">Troubleshooting</h4>
<ul>
<li>use OpenJDK 8: execute <code>sudo update-alternatives --config java</code> and select jdk-8 as default; or use <code>JAVA_HOME=/usr/lib/jvm/java-8-openjdk-amd64 ./gradlew</code></li>
<li>fixed in 2.0.9: in <code>/android-project/build.gradle</code> change (in BOTH places in the file code appears) from</li>
</ul>
<div class="sourceCode" id="cb5"><pre class="sourceCode c"><code class="sourceCode c"><a class="sourceLine" id="cb5-1" title="1">    repositories {</a>
<a class="sourceLine" id="cb5-2" title="2">        jcenter()</a>
<a class="sourceLine" id="cb5-3" title="3">    }</a></code></pre></div>
<p>to</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode c"><code class="sourceCode c"><a class="sourceLine" id="cb6-1" title="1">    repositories {</a>
<a class="sourceLine" id="cb6-2" title="2">        jcenter()</a>
<a class="sourceLine" id="cb6-3" title="3">        google()</a>
<a class="sourceLine" id="cb6-4" title="4">    }</a></code></pre></div>
<ul>
<li><code>javax/xml/bind/annotation/XmlSchema, Could not initialize class com.android.sdklib.repository.AndroidSdkHandler</code>: check the Android Gradle Plugin version in <code>/android-project/build.gradle</code>, e.g.</li>
</ul>
<p><code>classpath 'com.android.tools.build:gradle:3.1.0'</code></p>
<ul>
<li>You can customize the Gradle version in <code>/android-project/gradle/wrapper/gradle-wrapper.properties</code>:</li>
</ul>
<p><code>distributionUrl=https\://services.gradle.org/distributions/gradle-4.9-all.zip</code></p>
<ul>
<li>You can customize your SDK/NDK versions in </code>android-project/app/build.gradle</code>:</li>
</ul>
<div class="sourceCode" id="cb7"><pre class="sourceCode c"><code class="sourceCode c"><a class="sourceLine" id="cb7-1" title="1">android {</a>
<a class="sourceLine" id="cb7-2" title="2">    buildToolsVersion <span class="st">&quot;28.0.1&quot;</span></a>
<a class="sourceLine" id="cb7-3" title="3">    compileSdkVersion <span class="dv">28</span></a></code></pre></div>
<ul>
<li>You can customize your targets depending on the NDK version:</li>
</ul>
<div class="sourceCode" id="cb8"><pre class="sourceCode c"><code class="sourceCode c"><a class="sourceLine" id="cb8-1" title="1">externalNativeBuild {</a>
<a class="sourceLine" id="cb8-2" title="2">    ndkBuild {</a>
<a class="sourceLine" id="cb8-3" title="3">        arguments <span class="st">&quot;APP_PLATFORM=android-14&quot;</span></a>
<a class="sourceLine" id="cb8-4" title="4">        abiFilters &#39;armeabi-v7a&#39;, &#39;arm64-v8a&#39;, &#39;x86&#39;, &#39;x86_64&#39;</a></code></pre></div>
<ul>
<li><code>ABIs [x86_64, arm64-v8a] are not supported for platform. Supported ABIs are [armeabi, armeabi-v7a, x86, mips]</code>: upgrade to NDK &gt;= 10</li>
<li>Using ant (SDL &lt;= 2.0.7): edit <code>build-scripts/androidbuild.sh</code>, find the <code>$ANDROID update project</code> line, and add <code>--target android-XX</code> to it (replace XX with your installed API number)</li>
<li>TODO: check how we can use the distro's gradle instead of executing stuff from the Internet - <code>apt install gradle libgradle-android-plugin-java</code></li>
</ul>
<h3 id="sdl-wrapper-sdl_image-ndk-module">SDL wrapper + SDL_image NDK module</h3>
<p>Let's modify <code>SDL2_image/showimage.c</code> to show a simple embedded image (e.g. XPM).</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode c"><code class="sourceCode c"><a class="sourceLine" id="cb9-1" title="1"><span class="pp">#include </span><span class="im">&quot;SDL.h&quot;</span></a>
<a class="sourceLine" id="cb9-2" title="2"><span class="pp">#include </span><span class="im">&quot;SDL_image.h&quot;</span></a>
<a class="sourceLine" id="cb9-3" title="3"></a>
<a class="sourceLine" id="cb9-4" title="4"><span class="co">/* XPM */</span></a>
<a class="sourceLine" id="cb9-5" title="5"><span class="dt">static</span> <span class="dt">char</span> * icon_xpm[] = {</a>
<a class="sourceLine" id="cb9-6" title="6">  <span class="st">&quot;32 23 3 1&quot;</span>,</a>
<a class="sourceLine" id="cb9-7" title="7">  <span class="st">&quot;     c #FFFFFF&quot;</span>,</a>
<a class="sourceLine" id="cb9-8" title="8">  <span class="st">&quot;.    c #000000&quot;</span>,</a>
<a class="sourceLine" id="cb9-9" title="9">  <span class="st">&quot;+    c #FFFF00&quot;</span>,</a>
<a class="sourceLine" id="cb9-10" title="10">  <span class="st">&quot;                                &quot;</span>,</a>
<a class="sourceLine" id="cb9-11" title="11">  <span class="st">&quot;            ........            &quot;</span>,</a>
<a class="sourceLine" id="cb9-12" title="12">  <span class="st">&quot;          ..++++++++..          &quot;</span>,</a>
<a class="sourceLine" id="cb9-13" title="13">  <span class="st">&quot;         .++++++++++++.         &quot;</span>,</a>
<a class="sourceLine" id="cb9-14" title="14">  <span class="st">&quot;        .++++++++++++++.        &quot;</span>,</a>
<a class="sourceLine" id="cb9-15" title="15">  <span class="st">&quot;       .++++++++++++++++.       &quot;</span>,</a>
<a class="sourceLine" id="cb9-16" title="16">  <span class="st">&quot;      .++++++++++++++++++.      &quot;</span>,</a>
<a class="sourceLine" id="cb9-17" title="17">  <span class="st">&quot;      .+++....++++....+++.      &quot;</span>,</a>
<a class="sourceLine" id="cb9-18" title="18">  <span class="st">&quot;     .++++.. .++++.. .++++.     &quot;</span>,</a>
<a class="sourceLine" id="cb9-19" title="19">  <span class="st">&quot;     .++++....++++....++++.     &quot;</span>,</a>
<a class="sourceLine" id="cb9-20" title="20">  <span class="st">&quot;     .++++++++++++++++++++.     &quot;</span>,</a>
<a class="sourceLine" id="cb9-21" title="21">  <span class="st">&quot;     .++++++++++++++++++++.     &quot;</span>,</a>
<a class="sourceLine" id="cb9-22" title="22">  <span class="st">&quot;     .+++++++++..+++++++++.     &quot;</span>,</a>
<a class="sourceLine" id="cb9-23" title="23">  <span class="st">&quot;     .+++++++++..+++++++++.     &quot;</span>,</a>
<a class="sourceLine" id="cb9-24" title="24">  <span class="st">&quot;     .++++++++++++++++++++.     &quot;</span>,</a>
<a class="sourceLine" id="cb9-25" title="25">  <span class="st">&quot;      .++++++++++++++++++.      &quot;</span>,</a>
<a class="sourceLine" id="cb9-26" title="26">  <span class="st">&quot;      .++...++++++++...++.      &quot;</span>,</a>
<a class="sourceLine" id="cb9-27" title="27">  <span class="st">&quot;       .++............++.       &quot;</span>,</a>
<a class="sourceLine" id="cb9-28" title="28">  <span class="st">&quot;        .++..........++.        &quot;</span>,</a>
<a class="sourceLine" id="cb9-29" title="29">  <span class="st">&quot;         .+++......+++.         &quot;</span>,</a>
<a class="sourceLine" id="cb9-30" title="30">  <span class="st">&quot;          ..++++++++..          &quot;</span>,</a>
<a class="sourceLine" id="cb9-31" title="31">  <span class="st">&quot;            ........            &quot;</span>,</a>
<a class="sourceLine" id="cb9-32" title="32">  <span class="st">&quot;                                &quot;</span>};</a>
<a class="sourceLine" id="cb9-33" title="33"></a>
<a class="sourceLine" id="cb9-34" title="34"><span class="dt">int</span> main(<span class="dt">int</span> argc, <span class="dt">char</span> *argv[])</a>
<a class="sourceLine" id="cb9-35" title="35">{</a>
<a class="sourceLine" id="cb9-36" title="36">  SDL_Window *window;</a>
<a class="sourceLine" id="cb9-37" title="37">  SDL_Renderer *renderer;</a>
<a class="sourceLine" id="cb9-38" title="38">  SDL_Surface *surface;</a>
<a class="sourceLine" id="cb9-39" title="39">  SDL_Texture *texture;</a>
<a class="sourceLine" id="cb9-40" title="40">  <span class="dt">int</span> done;</a>
<a class="sourceLine" id="cb9-41" title="41">  SDL_Event event;</a>
<a class="sourceLine" id="cb9-42" title="42"></a>
<a class="sourceLine" id="cb9-43" title="43">  <span class="cf">if</span> (SDL_CreateWindowAndRenderer(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, &amp;window, &amp;renderer) &lt; <span class="dv">0</span>) {</a>
<a class="sourceLine" id="cb9-44" title="44">    SDL_LogError(SDL_LOG_CATEGORY_APPLICATION,</a>
<a class="sourceLine" id="cb9-45" title="45">        <span class="st">&quot;SDL_CreateWindowAndRenderer() failed: %s&quot;</span>, SDL_GetError());</a>
<a class="sourceLine" id="cb9-46" title="46">    <span class="cf">return</span>(<span class="dv">2</span>);</a>
<a class="sourceLine" id="cb9-47" title="47">  }</a>
<a class="sourceLine" id="cb9-48" title="48"></a>
<a class="sourceLine" id="cb9-49" title="49">  surface = IMG_ReadXPMFromArray(icon_xpm);</a>
<a class="sourceLine" id="cb9-50" title="50">  texture = SDL_CreateTextureFromSurface(renderer, surface);</a>
<a class="sourceLine" id="cb9-51" title="51">  <span class="cf">if</span> (!texture) {</a>
<a class="sourceLine" id="cb9-52" title="52">    SDL_LogError(SDL_LOG_CATEGORY_APPLICATION,</a>
<a class="sourceLine" id="cb9-53" title="53">        <span class="st">&quot;Couldn&#39;t load texture: %s&quot;</span>, SDL_GetError());</a>
<a class="sourceLine" id="cb9-54" title="54">    <span class="cf">return</span>(<span class="dv">2</span>);</a>
<a class="sourceLine" id="cb9-55" title="55">  }</a>
<a class="sourceLine" id="cb9-56" title="56">  SDL_SetWindowSize(window, <span class="dv">800</span>, <span class="dv">480</span>);</a>
<a class="sourceLine" id="cb9-57" title="57"></a>
<a class="sourceLine" id="cb9-58" title="58">  done = <span class="dv">0</span>;</a>
<a class="sourceLine" id="cb9-59" title="59">  <span class="cf">while</span> (!done) {</a>
<a class="sourceLine" id="cb9-60" title="60">    <span class="cf">while</span> (SDL_PollEvent(&amp;event)) {</a>
<a class="sourceLine" id="cb9-61" title="61">      <span class="cf">if</span> (event.type == SDL_QUIT)</a>
<a class="sourceLine" id="cb9-62" title="62">        done = <span class="dv">1</span>;</a>
<a class="sourceLine" id="cb9-63" title="63">    }</a>
<a class="sourceLine" id="cb9-64" title="64">    SDL_RenderCopy(renderer, texture, NULL, NULL);</a>
<a class="sourceLine" id="cb9-65" title="65">    SDL_RenderPresent(renderer);</a>
<a class="sourceLine" id="cb9-66" title="66">    SDL_Delay(<span class="dv">100</span>);</a>
<a class="sourceLine" id="cb9-67" title="67">  }</a>
<a class="sourceLine" id="cb9-68" title="68">  SDL_DestroyTexture(texture);</a>
<a class="sourceLine" id="cb9-69" title="69"></a>
<a class="sourceLine" id="cb9-70" title="70">  SDL_Quit();</a>
<a class="sourceLine" id="cb9-71" title="71">  <span class="cf">return</span>(<span class="dv">0</span>);</a>
<a class="sourceLine" id="cb9-72" title="72">}</a></code></pre></div>
<p>Then let's make an Android app out of it. To compile:</p>
<pre><code>cd /usr/src/SDL2/build-scripts/
./androidbuild.sh org.libsdl.showimage /usr/src/SDL2_image/showimage.c
cd /usr/src/SDL2/build/org.libsdl.showimage/
ln -s /usr/src/SDL2_image jni/
ln -s /usr/src/SDL2_image/external/libwebp-0.3.0 jni/webp
sed -i -e &#39;s/^LOCAL_SHARED_LIBRARIES.*/&amp; SDL2_image/&#39; jni/src/Android.mk
ndk-build -j$(nproc)
ant debug install</code></pre>
<p>Notes:</p>
<ul>
<li>application doesn't restart properly</li>
</ul>
<h2 id="build-an-autotools-friendly-environment">Build an autotools-friendly environment</h2>
<p>You use autotools in your project and can't be bothering understanding ndk-build's cryptic errors? This guide is for you!</p>
<p>Note: this environment can be used for CMake too.</p>
<h3 id="compile-a-shared-binaries-bundle-for-sdl-and-sdl_">Compile a shared binaries bundle for SDL and SDL_*</h3>
<ul>
<li>Get the latests SDL2_* releases:</li>
</ul>
<div class="sourceCode" id="cb11"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb11-1" title="1"><span class="bu">cd</span> /usr/src/</a>
<a class="sourceLine" id="cb11-2" title="2"><span class="fu">wget</span> https://libsdl.org/release/SDL2-2.0.5.tar.gz</a>
<a class="sourceLine" id="cb11-3" title="3"><span class="fu">wget</span> https://www.libsdl.org/projects/SDL_image/release/SDL2_image-2.0.1.tar.gz</a>
<a class="sourceLine" id="cb11-4" title="4"><span class="fu">wget</span> https://www.libsdl.org/projects/SDL_mixer/release/SDL2_mixer-2.0.1.tar.gz</a>
<a class="sourceLine" id="cb11-5" title="5"><span class="fu">wget</span> https://www.libsdl.org/projects/SDL_net/release/SDL2_net-2.0.1.tar.gz</a>
<a class="sourceLine" id="cb11-6" title="6"><span class="fu">wget</span> https://www.libsdl.org/projects/SDL_ttf/release/SDL2_ttf-2.0.14.tar.gz</a>
<a class="sourceLine" id="cb11-7" title="7"></a>
<a class="sourceLine" id="cb11-8" title="8"><span class="fu">tar</span> xf SDL2-2.0.5.tar.gz</a>
<a class="sourceLine" id="cb11-9" title="9"><span class="fu">tar</span> xf SDL2_image-2.0.1.tar.gz</a>
<a class="sourceLine" id="cb11-10" title="10"><span class="fu">tar</span> xf SDL2_mixer-2.0.1.tar.gz</a>
<a class="sourceLine" id="cb11-11" title="11"><span class="fu">tar</span> xf SDL2_net-2.0.1.tar.gz</a>
<a class="sourceLine" id="cb11-12" title="12"><span class="fu">tar</span> xf SDL2_ttf-2.0.14.tar.gz</a>
<a class="sourceLine" id="cb11-13" title="13"></a>
<a class="sourceLine" id="cb11-14" title="14"><span class="fu">ln</span> -s SDL2-2.0.5 SDL2</a>
<a class="sourceLine" id="cb11-15" title="15"><span class="fu">ln</span> -s SDL2_image-2.0.1 SDL2_image</a>
<a class="sourceLine" id="cb11-16" title="16"><span class="fu">ln</span> -s SDL2_mixer-2.0.1 SDL2_mixer</a>
<a class="sourceLine" id="cb11-17" title="17"><span class="fu">ln</span> -s SDL2_net-2.0.1 SDL2_net</a>
<a class="sourceLine" id="cb11-18" title="18"><span class="fu">ln</span> -s SDL2_ttf-2.0.14 SDL2_ttf</a></code></pre></div>
<ul>
<li>Start with a minimal build:</li>
</ul>
<div class="sourceCode" id="cb12"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb12-1" title="1"><span class="bu">cd</span> /usr/src/SDL2/</a>
<a class="sourceLine" id="cb12-2" title="2"><span class="bu">cd</span> build-scripts/</a>
<a class="sourceLine" id="cb12-3" title="3"><span class="co">#hg revert --all  # remove traces of previous builds</span></a>
<a class="sourceLine" id="cb12-4" title="4"><span class="co"># edit androidbuild.sh and modify $ANDROID update project --target android-XX</span></a>
<a class="sourceLine" id="cb12-5" title="5"><span class="ex">./androidbuild.sh</span> org.libsdl /dev/null</a>
<a class="sourceLine" id="cb12-6" title="6"><span class="co"># doesn&#39;t matter if the actual build fails, it&#39;s just for setup</span></a>
<a class="sourceLine" id="cb12-7" title="7"><span class="bu">cd</span> ../build/org.libsdl/</a></code></pre></div>
<ul>
<li>Remove reference to our dummy file:</li>
</ul>
<div class="sourceCode" id="cb13"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb13-1" title="1"><span class="fu">rm</span> -rf jni/src/</a></code></pre></div>
<ul>
<li>Reference SDL_image, SDL_mixer, SDL_ttf, and their dependencies, as NDK modules:</li>
</ul>
<div class="sourceCode" id="cb14"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb14-1" title="1"><span class="fu">ln</span> -s /usr/src/SDL2_image jni/</a>
<a class="sourceLine" id="cb14-2" title="2"><span class="fu">ln</span> -s /usr/src/SDL2_image/external/libwebp-0.3.0 jni/webp</a>
<a class="sourceLine" id="cb14-3" title="3"><span class="fu">ln</span> -s /usr/src/SDL2_mixer jni/</a>
<a class="sourceLine" id="cb14-4" title="4"><span class="fu">ln</span> -s /usr/src/SDL2_mixer/external/libmikmod-3.1.12 jni/libmikmod</a>
<a class="sourceLine" id="cb14-5" title="5"><span class="fu">ln</span> -s /usr/src/SDL2_mixer/external/smpeg2-2.0.0 jni/smpeg2</a>
<a class="sourceLine" id="cb14-6" title="6"><span class="fu">ln</span> -s /usr/src/SDL2_net jni/</a>
<a class="sourceLine" id="cb14-7" title="7"><span class="fu">ln</span> -s /usr/src/SDL2_ttf jni/</a></code></pre></div>
<ul>
<li>Optionnaly edit <code>jni/Android.mk</code> to disable some formats, e.g.:</li>
</ul>
<pre class="make"><code>SUPPORT_MP3_SMPEG := false
include $(call all-subdir-makefiles)</code></pre>
<ul>
<li>Launch the build!</li>
</ul>
<div class="sourceCode" id="cb16"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb16-1" title="1"><span class="ex">ndk-build</span> -j<span class="va">$(</span><span class="ex">nproc</span><span class="va">)</span></a></code></pre></div>
<p>Note: no need to add <code>System.loadLibrary</code> calls in <code>SDLActivity.java</code>, your application will be linked to them and Android's ld-linux loads them automatically.</p>
<h3 id="install-sdl-in-a-gcc-toolchain">Install SDL in a GCC toolchain</h3>
<p>Now:</p>
<ul>
<li>Copy the NDK into a traditional GCC toolchain (leave android-14 as-is):</li>
</ul>
<div class="sourceCode" id="cb17"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb17-1" title="1"><span class="ex">/usr/src/android-ndk-r8c/build/tools/make-standalone-toolchain.sh</span> \</a>
<a class="sourceLine" id="cb17-2" title="2">  --platform=android-14 --install-dir=/usr/src/ndk-standalone-14-arm --arch=arm</a></code></pre></div>
<ul>
<li>Set your PATH (important, do it before any build):</li>
</ul>
<div class="sourceCode" id="cb18"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb18-1" title="1"><span class="va">NDK_STANDALONE=</span>/usr/src/ndk-standalone-14-arm</a>
<a class="sourceLine" id="cb18-2" title="2"><span class="va">PATH=$NDK_STANDALONE</span>/bin:<span class="va">$PATH</span></a></code></pre></div>
<ul>
<li>Install the SDL2 binaries in the toolchain:</li>
</ul>
<div class="sourceCode" id="cb19"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb19-1" title="1"><span class="bu">cd</span> /usr/src/SDL2/build/org.libsdl/</a>
<a class="sourceLine" id="cb19-2" title="2"><span class="kw">for</span> <span class="ex">i</span> in libs/armeabi/*<span class="kw">;</span> <span class="kw">do</span> <span class="fu">ln</span> -nfs <span class="va">$(</span><span class="bu">pwd</span><span class="va">)</span>/<span class="va">$i</span> <span class="va">$NDK_STANDALONE</span>/sysroot/usr/lib/<span class="kw">;</span> <span class="kw">done</span></a>
<a class="sourceLine" id="cb19-3" title="3"><span class="fu">mkdir</span> <span class="va">$NDK_STANDALONE</span>/sysroot/usr/include/SDL2/</a>
<a class="sourceLine" id="cb19-4" title="4">\<span class="fu">cp</span> jni/SDL/include/* <span class="va">$NDK_STANDALONE</span>/sysroot/usr/include/SDL2/</a>
<a class="sourceLine" id="cb19-5" title="5">\<span class="fu">cp</span> jni/*/SDL*.h <span class="va">$NDK_STANDALONE</span>/sysroot/usr/include/SDL2/</a></code></pre></div>
<ul>
<li>Install <code>pkg-config</code> and install a host-triplet-prefixed symlink in the PATH (auto-detected by autoconf):</li>
</ul>
<div class="sourceCode" id="cb20"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb20-1" title="1"><span class="va">VERSION=</span>0.9.12</a>
<a class="sourceLine" id="cb20-2" title="2"><span class="bu">cd</span> /usr/src/</a>
<a class="sourceLine" id="cb20-3" title="3"><span class="fu">wget</span> http://rabbit.dereferenced.org/~nenolod/distfiles/pkgconf-<span class="va">$VERSION</span>.tar.gz</a>
<a class="sourceLine" id="cb20-4" title="4"><span class="fu">tar</span> xf pkgconf-<span class="va">$VERSION</span>.tar.gz</a>
<a class="sourceLine" id="cb20-5" title="5"><span class="bu">cd</span> pkgconf-<span class="va">$VERSION</span>/</a>
<a class="sourceLine" id="cb20-6" title="6"><span class="fu">mkdir</span> native-android/ <span class="kw">&amp;&amp;</span> <span class="bu">cd</span> native-android/</a>
<a class="sourceLine" id="cb20-7" title="7"><span class="ex">../configure</span> --prefix=<span class="va">$NDK_STANDALONE</span>/sysroot/usr</a>
<a class="sourceLine" id="cb20-8" title="8"><span class="fu">make</span> -j<span class="va">$(</span><span class="ex">nproc</span><span class="va">)</span></a>
<a class="sourceLine" id="cb20-9" title="9"><span class="fu">make</span> install</a>
<a class="sourceLine" id="cb20-10" title="10"><span class="fu">ln</span> -s ../sysroot/usr/bin/pkgconf <span class="va">$NDK_STANDALONE</span>/bin/arm-linux-androideabi-pkg-config</a>
<a class="sourceLine" id="cb20-11" title="11"><span class="fu">mkdir</span> <span class="va">$NDK_STANDALONE</span>/sysroot/usr/lib/pkgconfig/</a></code></pre></div>
<ul>
<li>Install pkg-config <code>.pc</code> files for SDL:</li>
</ul>
<div class="sourceCode" id="cb21"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb21-1" title="1"><span class="fu">cat</span> <span class="op">&lt;&lt;&#39;EOF&#39;</span> <span class="op">&gt;</span> <span class="va">$NDK_STANDALONE</span><span class="ex">/sysroot/usr/lib/pkgconfig/sdl2.pc</span></a>
<a class="sourceLine" id="cb21-2" title="2">prefix=/usr/src/ndk-standalone-14-arm/sysroot/usr</a>
<a class="sourceLine" id="cb21-3" title="3">exec_prefix=${prefix}</a>
<a class="sourceLine" id="cb21-4" title="4">libdir=${exec_prefix}/lib</a>
<a class="sourceLine" id="cb21-5" title="5">includedir=${prefix}/include</a>
<a class="sourceLine" id="cb21-6" title="6">Name: sdl2</a>
<a class="sourceLine" id="cb21-7" title="7">Description: Simple DirectMedia Layer is a <span class="op">c</span><span class="ex">ross-platform</span> multimedia library designed to provide low level access to audio, keyboard, mouse, joystick, 3D hardware via OpenGL, and 2D video framebuffer.</a>
<a class="sourceLine" id="cb21-8" title="8">Version: 2.0.5</a>
<a class="sourceLine" id="cb21-9" title="9">Requires:</a>
<a class="sourceLine" id="cb21-10" title="10">Conflicts:</a>
<a class="sourceLine" id="cb21-11" title="11">Libs: -lSDL2</a>
<a class="sourceLine" id="cb21-12" title="12">Cflags: -I${includedir}/SDL2   -D_REENTRANT</a>
<a class="sourceLine" id="cb21-13" title="13">EOF</a>
<a class="sourceLine" id="cb21-14" title="14"></a>
<a class="sourceLine" id="cb21-15" title="15">cat &lt;&lt;&#39;EOF&#39; &gt; $NDK_STANDALONE/sysroot/usr/lib/pkgconfig/SDL2_image.pc</a>
<a class="sourceLine" id="cb21-16" title="16">prefix=/usr/src/ndk-standalone-14-arm/sysroot/usr</a>
<a class="sourceLine" id="cb21-17" title="17">exec_prefix=${prefix}</a>
<a class="sourceLine" id="cb21-18" title="18">libdir=${exec_prefix}/lib</a>
<a class="sourceLine" id="cb21-19" title="19">includedir=${prefix}/include</a>
<a class="sourceLine" id="cb21-20" title="20">Name: SDL2_image</a>
<a class="sourceLine" id="cb21-21" title="21">Description: image loading library for Simple DirectMedia Layer</a>
<a class="sourceLine" id="cb21-22" title="22">Version: 2.0.1</a>
<a class="sourceLine" id="cb21-23" title="23">Requires: sdl2 &gt;= 2.0.0</a>
<a class="sourceLine" id="cb21-24" title="24">Libs: -L${libdir} -lSDL2_image</a>
<a class="sourceLine" id="cb21-25" title="25">Cflags: -I${includedir}/SDL2</a>
<a class="sourceLine" id="cb21-26" title="26">EOF</a>
<a class="sourceLine" id="cb21-27" title="27"></a>
<a class="sourceLine" id="cb21-28" title="28">cat &lt;&lt;&#39;EOF&#39; &gt; $NDK_STANDALONE/sysroot/usr/lib/pkgconfig/SDL2_<span class="op">m</span><span class="ex">ixer.pc</span></a>
<a class="sourceLine" id="cb21-29" title="29">prefix=/usr/src/ndk-standalone-14-arm/sysroot/usr</a>
<a class="sourceLine" id="cb21-30" title="30">exec_prefix=${prefix}</a>
<a class="sourceLine" id="cb21-31" title="31">libdir=${exec_prefix}/lib</a>
<a class="sourceLine" id="cb21-32" title="32">includedir=${prefix}/include</a>
<a class="sourceLine" id="cb21-33" title="33">Name: SDL2_mixer</a>
<a class="sourceLine" id="cb21-34" title="34">Description: mixer library for Simple DirectMedia Layer</a>
<a class="sourceLine" id="cb21-35" title="35">Version: 2.0.1</a>
<a class="sourceLine" id="cb21-36" title="36">Requires: sdl2 &gt;= 2.0.0</a>
<a class="sourceLine" id="cb21-37" title="37">Libs: -L${libdir} -lSDL2_mixer</a>
<a class="sourceLine" id="cb21-38" title="38">Cflags: -I${includedir}/SDL2</a>
<a class="sourceLine" id="cb21-39" title="39">EOF</a>
<a class="sourceLine" id="cb21-40" title="40"></a>
<a class="sourceLine" id="cb21-41" title="41"><span class="op">c</span><span class="ex">at</span> <span class="op">&lt;&lt;&#39;EOF&#39;</span> <span class="op">&gt;</span> <span class="va">$NDK_STANDALONE</span><span class="ex">/sysroot/usr/lib/pkgconfig/SDL2_net.pc</span></a>
<a class="sourceLine" id="cb21-42" title="42">prefix=/usr/src/ndk-standalone-14-arm/sysroot/usr</a>
<a class="sourceLine" id="cb21-43" title="43">exec_prefix=${prefix}</a>
<a class="sourceLine" id="cb21-44" title="44">libdir=${exec_prefix}/lib</a>
<a class="sourceLine" id="cb21-45" title="45">includedir=${prefix}/include</a>
<a class="sourceLine" id="cb21-46" title="46">Name: SDL2_net</a>
<a class="sourceLine" id="cb21-47" title="47">Description: net library for Simple DirectMedia Layer</a>
<a class="sourceLine" id="cb21-48" title="48">Version: 2.0.1</a>
<a class="sourceLine" id="cb21-49" title="49">Requires: sdl2 &gt;= 2.0.0</a>
<a class="sourceLine" id="cb21-50" title="50">Libs: -L${libdir} -lSDL2_net</a>
<a class="sourceLine" id="cb21-51" title="51">Cflags: -I${includedir}/SDL2</a>
<a class="sourceLine" id="cb21-52" title="52">EOF</a>
<a class="sourceLine" id="cb21-53" title="53"></a>
<a class="sourceLine" id="cb21-54" title="54"><span class="op">c</span><span class="ex">at</span> <span class="op">&lt;&lt;&#39;EOF&#39;</span> <span class="op">&gt;</span> <span class="va">$NDK_STANDALONE</span><span class="ex">/sysroot/usr/lib/pkgconfig/SDL2_ttf.pc</span></a>
<a class="sourceLine" id="cb21-55" title="55">prefix=/usr/src/ndk-standalone-14-arm/sysroot/usr</a>
<a class="sourceLine" id="cb21-56" title="56">exec_prefix=${prefix}</a>
<a class="sourceLine" id="cb21-57" title="57">libdir=${exec_prefix}/lib</a>
<a class="sourceLine" id="cb21-58" title="58">includedir=${prefix}/include</a>
<a class="sourceLine" id="cb21-59" title="59">Name: SDL2_ttf</a>
<a class="sourceLine" id="cb21-60" title="60">Description: ttf library for Simple DirectMedia Layer with FreeType 2 support</a>
<a class="sourceLine" id="cb21-61" title="61">Version: 2.0.14</a>
<a class="sourceLine" id="cb21-62" title="62">Requires: sdl2 &gt;= 2.0.0</a>
<a class="sourceLine" id="cb21-63" title="63">Libs: -L${libdir} -lSDL2_ttf</a>
<a class="sourceLine" id="cb21-64" title="64">Cflags: -I${includedir}/SDL2</a>
<a class="sourceLine" id="cb21-65" title="65">EOF</a></code></pre></div>
<h3 id="building-other-dependencies">Building other dependencies</h3>
<p>You can add any other libraries (e.g.: SDL2_gfx, freetype, gettext, gmp...) using commands like:</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb22-1" title="1"><span class="fu">mkdir</span> cross-android/ <span class="kw">&amp;&amp;</span> <span class="bu">cd</span> cross-android/</a>
<a class="sourceLine" id="cb22-2" title="2"><span class="ex">../configure</span> --host=arm-linux-androideabi --prefix=<span class="va">$NDK_STANDALONE</span>/sysroot/usr \</a>
<a class="sourceLine" id="cb22-3" title="3">  --with-some-option --enable-another-option \</a>
<a class="sourceLine" id="cb22-4" title="4">  --disable-shared</a>
<a class="sourceLine" id="cb22-5" title="5"><span class="fu">make</span> -j<span class="va">$(</span><span class="ex">nproc</span><span class="va">)</span></a>
<a class="sourceLine" id="cb22-6" title="6"><span class="fu">make</span> install</a></code></pre></div>
<p>Static builds (<code>--disable-shared</code>) are recommended for simplicity (no additional <code>.so</code> to declare).</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb23-1" title="1"><span class="ex">Example</span> with SDL2_gfx:</a>
<a class="sourceLine" id="cb23-2" title="2"><span class="va">VERSION=</span>1.0.3</a>
<a class="sourceLine" id="cb23-3" title="3"><span class="fu">wget</span> http://www.ferzkopp.net/Software/SDL2_gfx/SDL2_gfx-<span class="va">$VERSION</span>.tar.gz</a>
<a class="sourceLine" id="cb23-4" title="4"><span class="fu">tar</span> xf SDL2_gfx-<span class="va">$VERSION</span>.tar.gz</a>
<a class="sourceLine" id="cb23-5" title="5"><span class="fu">mv</span> SDL2_gfx-<span class="va">$VERSION</span>/ SDL2_gfx/</a>
<a class="sourceLine" id="cb23-6" title="6"><span class="bu">cd</span> SDL2_gfx/</a>
<a class="sourceLine" id="cb23-7" title="7"><span class="fu">mkdir</span> cross-android/ <span class="kw">&amp;&amp;</span> <span class="bu">cd</span> cross-android/</a>
<a class="sourceLine" id="cb23-8" title="8"><span class="ex">../configure</span> --host=arm-linux-androideabi --prefix=<span class="va">$NDK_STANDALONE</span>/sysroot/usr \</a>
<a class="sourceLine" id="cb23-9" title="9">  --disable-shared --disable-mmx</a>
<a class="sourceLine" id="cb23-10" title="10"><span class="fu">make</span> -j<span class="va">$(</span><span class="ex">nproc</span><span class="va">)</span></a>
<a class="sourceLine" id="cb23-11" title="11"><span class="fu">make</span> install</a></code></pre></div>
<p>You can compile YOUR application using this technique, with some more steps to tell Android how to run it using JNI.</p>
<h3 id="build-your-autotools-app">Build your autotools app</h3>
<p>First, prepare an Android project:</p>
<ul>
<li>Copy and adapt the <code>/usr/src/SDL2/android-project</code> skeleton as explained in <code>README-android.md</code>. You can leave it as-is in a first step.</li>
<li>Make links to the SDL binaries as well:</li>
</ul>
<div class="sourceCode" id="cb24"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb24-1" title="1"><span class="fu">mkdir</span> -p libs/armeabi/</a>
<a class="sourceLine" id="cb24-2" title="2"><span class="kw">for</span> <span class="ex">i</span> in /usr/src/SDL2/build/org.libsdl/libs/armeabi/*<span class="kw">;</span> <span class="kw">do</span> <span class="fu">ln</span> -nfs <span class="va">$i</span> libs/armeabi/<span class="kw">;</span> <span class="kw">done</span></a></code></pre></div>
<p>Make your project Android-aware:</p>
<ul>
<li>Add <code>/usr/src/SDL2/src/main/android/SDL_android_main.c</code> in your project (comment out the line referencing "SDL_internal.h"). Compile it as C (not C++).</li>
<li>In your <code>configure.ac</code>, detect Android:</li>
</ul>
<div class="sourceCode" id="cb25"><pre class="sourceCode c"><code class="sourceCode c"><a class="sourceLine" id="cb25-1" title="1">AM_CONDITIONAL(ANDROID, test <span class="st">&quot;$host&quot;</span> = <span class="st">&quot;arm-unknown-linux-androideabi&quot;</span>)</a></code></pre></div>
<ul>
<li>In your <code>Makefile.am</code>, tell Automake you'll build executables as libraries, using something like:</li>
</ul>
<div class="sourceCode" id="cb26"><pre class="sourceCode C"><code class="sourceCode c"><a class="sourceLine" id="cb26-1" title="1"><span class="cf">if</span> ANDROID</a>
<a class="sourceLine" id="cb26-2" title="2">&lt;!--  Build .so JNI libs rather than executables --&gt;</a>
<a class="sourceLine" id="cb26-3" title="3">  AM_CFLAGS = -fPIC</a>
<a class="sourceLine" id="cb26-4" title="4">  AM_LDFLAGS += -shared</a>
<a class="sourceLine" id="cb26-5" title="5">  COMMON_OBJS += SDL_android_main.c</a>
<a class="sourceLine" id="cb26-6" title="6">endif</a></code></pre></div>
<ul>
<li>Cross-compile your project using the GCC toolchain environment we created:</li>
</ul>
<div class="sourceCode" id="cb27"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb27-1" title="1"><span class="va">PATH=$NDK_STANDALONE</span>/bin:<span class="va">$PATH</span></a>
<a class="sourceLine" id="cb27-2" title="2"><span class="fu">mkdir</span> cross-android/ <span class="kw">&amp;&amp;</span> <span class="bu">cd</span> cross-android/</a>
<a class="sourceLine" id="cb27-3" title="3"><span class="ex">../configure</span> --host=arm-linux-androideabi \</a>
<a class="sourceLine" id="cb27-4" title="4">  --prefix=/android-aint-posix \</a>
<a class="sourceLine" id="cb27-5" title="5">  --with-your-option --enable-your-other-option ...</a>
<a class="sourceLine" id="cb27-6" title="6"><span class="fu">make</span></a></code></pre></div>
<ul>
<li>Do this again for any additional arch you want to support (TODO: see how to support <code>armeabi-v7a</code> and document what devices support it); something like:</li>
</ul>
<div class="sourceCode" id="cb28"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb28-1" title="1"><span class="fu">mkdir</span> cross-android-v7a/ <span class="kw">&amp;&amp;</span> <span class="bu">cd</span> cross-android-v7a/</a>
<a class="sourceLine" id="cb28-2" title="2"><span class="co"># .o: -march=armv5te -mtune=xscale -msoft-float -mthumb  =&gt;  -march=armv7-a -mfpu=vfpv3-d16 -mfloat-abi=softfp -mthumb</span></a>
<a class="sourceLine" id="cb28-3" title="3"><span class="co"># .so: -march=armv7-a -Wl,--fix-cortex-a8</span></a>
<a class="sourceLine" id="cb28-4" title="4"><span class="va">CFLAGS=</span><span class="st">&quot;-g -O2 -march=armv7-a -mfpu=vfpv3-d16 -mfloat-abi=softfp -mthumb&quot;</span> <span class="va">LFDLAGS=</span><span class="st">&quot;-march=armv7-a -Wl,--fix-cortex-a8&quot;</span> <span class="kw">\</span></a>
<a class="sourceLine" id="cb28-5" title="5">  <span class="ex">../configure</span> --host=arm-linux-androideabi \</a>
<a class="sourceLine" id="cb28-6" title="6">  ...</a></code></pre></div>
<p>Now you can install your pre-built binaries and build the Android project:</p>
<ul>
<li>Copy your program in <code>android-project/libs/armeabi/libmain.so</code>.</li>
<li>Build your Android <code>.apk</code>:</li>
</ul>
<div class="sourceCode" id="cb29"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb29-1" title="1"><span class="ex">android</span> update project --name your_app --path . --target android-XX</a>
<a class="sourceLine" id="cb29-2" title="2"><span class="ex">ant</span> debug</a>
<a class="sourceLine" id="cb29-3" title="3"><span class="ex">ant</span> installd</a></code></pre></div>
<ul>
<li>You can run the application remotely:</li>
</ul>
<div class="sourceCode" id="cb30"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb30-1" title="1"><span class="ex">adb</span> shell am start -a android.intenon.MAIN -n org.libsdl.app/org.libsdl.app.SDLActivity  <span class="co"># replace with your app package</span></a></code></pre></div>
<ul>
<li>Your SDL2 Android app is running!</li>
</ul>
<h3 id="build-your-cmake-app">Build your CMake app</h3>
<p>(Work In Progress)</p>
<p>You can use our Android GCC toolchain using a simple toolchain file:</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode cmake"><code class="sourceCode cmake"><a class="sourceLine" id="cb31-1" title="1"><span class="co"># CMake toolchain file</span></a>
<a class="sourceLine" id="cb31-2" title="2"><span class="kw">SET</span>(<span class="dv">CMAKE_SYSTEM_NAME</span> Linux)  <span class="co"># Tell CMake we&#39;re cross-compiling</span></a>
<a class="sourceLine" id="cb31-3" title="3"><span class="kw">include</span>(CMakeForceCompiler)</a>
<a class="sourceLine" id="cb31-4" title="4"><span class="co"># Prefix detection only works with compiler id &quot;GNU&quot;</span></a>
<a class="sourceLine" id="cb31-5" title="5"><span class="fu">CMAKE_FORCE_C_COMPILER</span>(arm-linux-androideabi-gcc GNU)</a>
<a class="sourceLine" id="cb31-6" title="6"><span class="kw">SET</span>(<span class="dv">ANDROID</span> TRUE)</a></code></pre></div>
<p>You then call CMake like this:</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb32-1" title="1"><span class="va">PATH=$NDK_STANDALONE</span>/bin:<span class="va">$PATH</span></a>
<a class="sourceLine" id="cb32-2" title="2"><span class="fu">cmake</span> \</a>
<a class="sourceLine" id="cb32-3" title="3">  -D CMAKE_TOOLCHAIN_FILE=../android_toolchain.cmake \</a>
<a class="sourceLine" id="cb32-4" title="4">  ...</a></code></pre></div>
<h2 id="troubleshootings">Troubleshootings</h2>
<p>If <code>ant installd</code> categorically refuses to install with <code>Failure [INSTALL_FAILED_INSUFFICIENT_STORAGE]</code>, even if you have free local storage, that may mean anything. Check logcat first:</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb33-1" title="1"><span class="ex">adb</span> logcat</a></code></pre></div>
<p>If the error logs are not helpful (likely ;')) try locating all past traces of the application:</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb34-1" title="1"><span class="fu">find</span> / -name <span class="st">&quot;org....&quot;</span></a></code></pre></div>
<p>and remove them all.</p>
<p>If the problem persists, you may try installing on the SD card:</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb35-1" title="1"><span class="ex">adb</span> install -s bin/app-debug.apk</a></code></pre></div>
<hr />
<p>If you get in your logcat:</p>
<p><code>SDL: Couldn't locate Java callbacks, check that they're named and typed correctly</code></p>
<p>this probably means your <code>SDLActivity.java</code> is out-of-sync with your libSDL2.so.</p>
</body>
</html>
